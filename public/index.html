<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lua Linter</title>

    <!-- CodeMirror Styles -->
    <link rel="stylesheet" href="codemirror/lib/codemirror.css">
    <link rel="stylesheet" href="codemirror/theme/monokai.css">
    <link rel="stylesheet" href="codemirror/addon/lint/lint.css">
    <link rel="stylesheet" href="styles.css">

    <!-- CodeMirror Scripts -->
    <script src="codemirror/lib/codemirror.js"></script>
    <script src="codemirror/mode/lua/lua.js"></script>
    <script src="codemirror/keymap/sublime.js"></script>
    <script src="codemirror/addon/lint/lint.js"></script>

    <!-- Other Scripts -->
    <script src="editor.js"></script>
    <script src="rts.js"></script>
    <script src="lib.js"></script>
    <script src="out.js"></script>
  </head>

  <body>
    <h1>Lua Code Linter</h1>

    <!-- Code Editor -->
    <textarea id="codeInput"></textarea>

    <!-- Lint Button -->
    <button id="lintButton">Lint Code</button>

    <!-- Lint Results -->
    <pre id="results"></pre>

    <!-- Run Main Script -->
    <script src="runmain.js" defer></script>
    <script src="script.js"></script>

    <script>
      // Initialize CodeMirror
      var editor = CodeMirror.fromTextArea(document.getElementById("codeInput"), {
        mode: "lua",
        theme: "monokai",
        lineNumbers: true,
        gutters: ["CodeMirror-lint-markers"],
        lint: true
      });

      document.getElementById("lintButton").addEventListener("click", function () {
        const code = editor.getValue();

        fetch('/api/lint', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ code })
        })
        .then(response => response.json())
        .then(data => {
          document.getElementById("results").textContent = data.message || "No issues found!";
        })
        .catch(error => {
          console.error("Error:", error);
        });
      });
    </script>
  </body>
</html>
